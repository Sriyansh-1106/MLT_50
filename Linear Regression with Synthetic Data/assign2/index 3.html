<!DOCTYPE html>
<html>
<head>
  <title>Learning Rate Comparison</title>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs"></script>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-vis"></script>
</head>

<body>
<h3>Learning Rate Effect</h3>

<input type="number" id="userInput" placeholder="Enter X value">
<button onclick="predict()">Predict</button>

<h4 id="output"></h4>

<script>
let finalModel;

// Training function
async function trainModel(lr, name){
  const xs = tf.tensor2d([1,2,3,4,5,6],[6,1]);
  const ys = tf.tensor2d([3,5,7,9,11,13],[6,1]);

  const model = tf.sequential();
  model.add(tf.layers.dense({units:1,inputShape:[1]}));

  model.compile({
    optimizer: tf.train.sgd(lr),
    loss:'meanSquaredError'
  });

  await model.fit(xs, ys, {
    epochs:60,
    callbacks: tfvis.show.fitCallbacks(
      {name:name},
      ['loss'],
      {height:200}
    )
  });

  // Save last trained model for prediction
  finalModel = model;
}

// Train models
trainModel(0.01,"LR = 0.01");
trainModel(0.1,"LR = 0.1");

// Normal input prediction
function predict(){
  const val = Number(document.getElementById("userInput").value);

  const pred = finalModel.predict(tf.tensor2d([val],[1,1]));
  pred.data().then(res=>{
    document.getElementById("output").innerText =
      "Predicted Y â‰ˆ " + res[0].toFixed(2);
  });
}

// Console prediction
window.predictValue = function(x){
  const pred = finalModel.predict(tf.tensor2d([x],[1,1]));
  pred.print();
};
</script>

</body>
</html>
