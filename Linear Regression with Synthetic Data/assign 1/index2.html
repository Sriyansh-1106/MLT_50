<!DOCTYPE html>
<html>
<head>
  <title>Regression Prediction Graph</title>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs"></script>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-vis"></script>
</head>

<body>

<h3>Predicted vs Actual</h3>

<input type="number" id="userInput" placeholder="Enter X">
<button onclick="predict()">Predict</button>

<h4 id="output"></h4>

<script>
let model;

async function run(){
  const xs = tf.tensor2d([1,2,3,4,5,6],[6,1]);
  const ys = tf.tensor2d([3,5,7,9,11,13],[6,1]);

  model = tf.sequential();
  model.add(tf.layers.dense({units:1,inputShape:[1]}));
  model.compile({optimizer:'sgd', loss:'meanSquaredError'});

  await model.fit(xs, ys, {epochs:100});

  const preds = model.predict(xs);

  const xVals = Array.from(xs.dataSync());
  const yVals = Array.from(ys.dataSync());
  const pVals = Array.from(preds.dataSync());

  const actual = xVals.map((x,i)=>({x:x,y:yVals[i]}));
  const predicted = xVals.map((x,i)=>({x:x,y:pVals[i]}));

  tfvis.render.scatterplot(
    {name:"Actual vs Predicted"},
    {values:[actual,predicted],
     series:["Actual","Predicted"]},
    {xLabel:"X",yLabel:"Y",height:300}
  );

  console.log("Training complete");
}

function predict(){
  const val = Number(document.getElementById("userInput").value);

  const pred = model.predict(tf.tensor2d([val],[1,1]));
  pred.data().then(res=>{
    document.getElementById("output").innerText =
      "Predicted Y â‰ˆ " + res[0].toFixed(2);
  });
}

run();
</script>

</body>
</html>
